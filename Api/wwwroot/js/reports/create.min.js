var chart=null;$("#create").on("submit",function(){if($(this)[0].checkValidity()){var e=this.reportTitle.value,t=this.startDate.value,a=this.endDate.value;customSwal.fire({title:"Generating report...",html:'<div style="min-height:150px"><div class="spinner"></div></div>',allowEscapeKey:!1,allowOutsideClick:!1,showConfirmButton:!1,showCancelButton:!1,showCloseButton:!1,didOpen(){setTimeout(function(){$.ajax({type:"POST",url:"/Reports/Create",data:$("#create").serialize(),dataType:"JSON",success:function(o){null!=chart&&chart.destroy();var r=0,n=0,i=0,s=0;o.forEach(e=>{e.forEach(e=>{switch(e.executionStatus){case 1:s+=1;break;case 2:i+=1;break;case 3:n+=1;break;case 4:r+=1}})});var l=r+n+i+s,d=document.getElementById("chart").getContext("2d");(chart=new Chart(d,{type:"doughnut",data:{labels:["Pass","Fail","Stop","Not run"],datasets:[{label:"Executions",backgroundColor:["rgba(95, 167, 88, 0.6)","rgba(215, 75, 61, 0.6)","rgba(255, 227, 81, 0.6)","rgba(114, 165, 217, 0.6)"],borderColor:["rgba(95, 167, 88, 0.6)","rgba(215, 75, 61, 0.6)","rgba(255, 227, 81, 0.6)","rgba(114, 165, 217, 0.6)"],data:[r,n,i,s],borderWidth:2}]},options:{animation:{duration:2e3},responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:e}}}})).canvas.parentNode.style.height="400px",chart.canvas.parentNode.style.width="400px",l>0?(document.getElementById("downloadReportButton")&&document.getElementById("downloadReportButton").remove(),$('<a class="btn btn-kiwi" id="downloadReportButton" href="/Reports/Download?startDate='+t+"&endDate="+a+"&reportTitle="+e+'"><i class="fa fa-download"></i> Download report</a>').appendTo(document.getElementById("downloadReport")),$("#footerDiv").show()):$("#footerDiv").hide(),customSwal.close()},error:function(){customSwal.fire("Incorrect","An unexpected error occurred!","error")}})},2e3)}})}return!1});